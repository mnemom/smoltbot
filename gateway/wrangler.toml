name = "smoltbot-gateway"
main = "src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# Custom domain
routes = [
  { pattern = "gateway.mnemom.ai", custom_domain = true }
]

workers_dev = true

[vars]
GATEWAY_VERSION = "2.0.0"
BILLING_ENFORCEMENT_ENABLED = "true"

# Billing quota cache â€” create with: wrangler kv:namespace create BILLING_CACHE
# Then fill in the id below. Preview namespace: wrangler kv:namespace create BILLING_CACHE --preview
[[kv_namespaces]]
binding = "BILLING_CACHE"
id = "d13bd450c5ab4a2c9766f2dc26ce513c"

# Secrets (set via wrangler secret put):
# SUPABASE_URL
# SUPABASE_KEY
# CF_AI_GATEWAY_URL
# OTLP_ENDPOINT  (Grafana Cloud / OTel collector)
# OTLP_AUTH       (e.g. "Basic <base64>")

# Phase 7: Self-hosted deployment (optional, only set for self-hosted gateways)
# MNEMOM_ANALYZE_URL  (e.g. "https://api.mnemom.ai/v1/analyze")
# MNEMOM_API_KEY      (mnm_ key with analyze scope)
# MNEMOM_LICENSE_JWT  (Enterprise license JWT)
